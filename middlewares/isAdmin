// import verifyToken from "../utils/verifyToken";

const Admin = require("../models/Staff/admin");

const verifyToken = require("../utils/verifyToken");

const isAdmin = async (req, res, next) => {
    // find user
   const userId = req.userAuth._id
   const userFound = await Admin.findById(userId);
   // check if is an admin
   if (userFound?.role === "admin") {
        next();
   } else {
        next(new Error("Access Denied, admin only"))
   }
}

module.exports = isAdmin;